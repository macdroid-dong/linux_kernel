<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36" version="24.7.17">
  <diagram name="第 1 页" id="5c_sdv3xem8xDv6UHyA0">
    <mxGraphModel dx="4071" dy="2134" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="rQGNHsxmuD68EuWlFp72-196" value="&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center&quot;&gt;&lt;b&gt;struct kset&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;//用来将起中的object对象构建成链表&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;struct list_head &lt;font color=&quot;#ff3333&quot;&gt;list&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;//自旋锁&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;spinlock_t &lt;font color=&quot;#ff3333&quot;&gt;list_lock&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;//当前kset内核对象的kobject变量&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;struct kobject&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;&lt;span&gt;;&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;//定义了一组函数指针，当kset中的某些kobject对象发生状态变化需要通知用户空间时&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;//，调用其中的函数来完成&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;const struct kset_uevent_ops *&lt;font color=&quot;#ff3333&quot;&gt;uevent_ops&lt;/font&gt;;&lt;/p&gt;&lt;/blockquote&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="1360" y="3520" width="520" height="190" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-197" value="&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center&quot;&gt;&lt;span style=&quot;text-align: left&quot;&gt;&lt;b&gt;struct kobject&lt;/b&gt;&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;//用来表示该kobject的名称&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;const char&lt;span&gt;&#x9;&#x9;&lt;/span&gt;*&lt;font color=&quot;#ff3333&quot;&gt;name&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;//链表节点&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;struct list_head&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#ff3333&quot;&gt;entry&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;//该kobject的上层节点，构建kobject之间的层次关系&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;struct kobject&lt;span&gt;&#x9;&#x9;&lt;/span&gt;*&lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;//该kobject上层的kset对象，kset用于批量管理kobject对象&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;struct kset&lt;span&gt;&#x9;&#x9;&lt;/span&gt;*&lt;font color=&quot;#ff3333&quot;&gt;kset&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;//该Kobject的sysfs文件系统相关的操作和属性&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;struct kobj_type&lt;span&gt;&#x9;&lt;/span&gt;*&lt;font color=&quot;#ff3333&quot;&gt;ktype&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;//该kobject在sysfs文件系统中对应目录项&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;struct kernfs_node&lt;span&gt;&#x9;&lt;/span&gt;*&lt;font color=&quot;#ff3333&quot;&gt;sd&lt;/font&gt;; &lt;font color=&quot;#999999&quot;&gt;/* sysfs directory entry */&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;//该kobject的引用次数&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;struct kref&lt;span&gt;&#x9;&#x9;&lt;/span&gt;&lt;font color=&quot;#ff3333&quot;&gt;kref&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;#ifdef CONFIG_DEBUG_KOBJECT_RELEASE&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;struct delayed_work&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#ff3333&quot;&gt;release&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;#endif&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;//记录内核对象的初始化状态&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;unsigned int &lt;font color=&quot;#ff3333&quot;&gt;state_initialized&lt;/font&gt;:1;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;//表示该kobject所代表的内核对象有没有在sysfs建立目录&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;unsigned int &lt;font color=&quot;#ff3333&quot;&gt;state_in_sysfs&lt;/font&gt;:1;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;unsigned int &lt;font color=&quot;#ff3333&quot;&gt;state_add_uevent_sent&lt;/font&gt;:1;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;unsigned int &lt;font color=&quot;#ff3333&quot;&gt;state_remove_uevent_sent&lt;/font&gt;:1;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;unsigned int &lt;font color=&quot;#ff3333&quot;&gt;uevent_suppress&lt;/font&gt;:1;&lt;/p&gt;&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="1360" y="1440" width="380" height="460" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-198" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="1360" y="1456" width="380" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-199" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="1360" y="3536" width="520" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-200" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;struct kobj_type&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;//销毁kobject对象时调用&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&#x9;void (*&lt;font color=&quot;#ff3333&quot;&gt;release&lt;/font&gt;)(struct kobject *kobj);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;//kobject对象属性文件统一操作接口&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&#x9;const struct sysfs_ops *&lt;font color=&quot;#ff3333&quot;&gt;sysfs_ops&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;//kobject默认属性文件的名字、&quot;文件具体操作接口&quot;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&#x9;struct attribute **&lt;font color=&quot;#ff3333&quot;&gt;default_attrs&lt;/font&gt;;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&#x9;const struct kobj_ns_type_operations *(*&lt;font color=&quot;#ff3333&quot;&gt;child_ns_type&lt;/font&gt;)(struct kobject *kobj);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&#x9;const void *(*&lt;font color=&quot;#ff3333&quot;&gt;namespace&lt;/font&gt;)(struct kobject *kobj);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&#x9;void (*&lt;font color=&quot;#ff3333&quot;&gt;get_ownership&lt;/font&gt;)(struct kobject *kobj, kuid_t *uid, kgid_t *gid);&lt;/p&gt;&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="5200" y="2001" width="480" height="190" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-201" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="5200" y="2017" width="480" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-202" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;struct kobject *&lt;font color=&quot;#3333ff&quot;&gt;kobject_create_and_add&lt;/font&gt;(const char *&lt;font color=&quot;#ff3333&quot;&gt;name&lt;/font&gt;, struct kobject *&lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;)&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&#x9;struct kobject *&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;int &lt;font color=&quot;#ff3333&quot;&gt;retval&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;/*创建并初始化一个kobject对象*/&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt; = &lt;font color=&quot;#3333ff&quot;&gt;kobject_create&lt;/font&gt;();&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;if (!&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;)&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;return NULL;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;/*sysfs创建一个目录项并与kobject对象关联*/&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#ff3333&quot;&gt;retval&lt;/font&gt; = &lt;font color=&quot;#3333ff&quot;&gt;kobject_add&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;, &quot;%s&quot;, &lt;font color=&quot;#ff3333&quot;&gt;name&lt;/font&gt;);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;if (&lt;font color=&quot;#ff3333&quot;&gt;retval&lt;/font&gt;) {&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#3333ff&quot;&gt;pr_warn&lt;/font&gt;(&quot;%s: kobject_add error: %d\n&quot;, &lt;font color=&quot;#ff3333&quot;&gt;__func__&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;retval&lt;/font&gt;);&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#3333ff&quot;&gt;kobject_put&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;);&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt; = NULL;&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;}&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&#x9;return &lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;;&lt;/p&gt;&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="1360" y="1000" width="520" height="280" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-203" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="1360" y="1016" width="520" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-204" value="&lt;b&gt;&lt;font color=&quot;#000000&quot;&gt;include/linux/kobject.h&lt;/font&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#FF3333;" vertex="1" parent="1">
          <mxGeometry x="5200" y="1981" width="140" height="20" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-205" value="&lt;b&gt;&lt;font color=&quot;#000000&quot;&gt;include/linux/kobject.h&lt;/font&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#FF3333;" vertex="1" parent="1">
          <mxGeometry x="1360" y="1420" width="140" height="20" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-206" value="&lt;b&gt;&lt;font color=&quot;#000000&quot;&gt;include/linux/kobject.h&lt;/font&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#FF3333;" vertex="1" parent="1">
          <mxGeometry x="1360" y="3500" width="140" height="20" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-207" value="&lt;b&gt;lib/kobject.c&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="1360" y="980" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-208" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;struct kobject *&lt;font color=&quot;#3333ff&quot;&gt;kobject_create&lt;/font&gt;(void)&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;struct kobject *&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;/*动态申请内存，存放kobject对象*/&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt; = &lt;font color=&quot;#3333ff&quot;&gt;kzalloc&lt;/font&gt;(sizeof(*&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;), GFP_KERNEL);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;if (!&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;)&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;return NULL;&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#3333ff&quot;&gt;kobject_init&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;, &amp;amp;dynamic_kobj_ktype);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;return &lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;;&lt;/p&gt;&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="1960" y="1000" width="320" height="150" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-209" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="1960" y="1016" width="320" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-210" value="&lt;b&gt;lib/kobject.c&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="1960" y="980" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-211" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;void &lt;font color=&quot;#3333ff&quot;&gt;kobject_init&lt;/font&gt;(struct kobject *&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;, struct kobj_type *&lt;font color=&quot;#ff3333&quot;&gt;ktype&lt;/font&gt;)&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;span&gt;...&lt;/span&gt;&lt;br&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;kobject_init_internal(&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;);&lt;br&gt;&lt;/span&gt;&lt;span&gt;&lt;font color=&quot;#999999&quot;&gt;/*设置目录属性文件的操作接口*/&lt;/font&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;ktype&lt;/font&gt; = &lt;font color=&quot;#ff3333&quot;&gt;ktype&lt;/font&gt;;&lt;br&gt;&lt;/span&gt;&lt;span&gt;return;&lt;/span&gt;&lt;/blockquote&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;...&lt;/span&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="2520" y="920" width="400" height="120" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-212" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="2520" y="936" width="400" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-213" value="&lt;b&gt;lib/kobject.c&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="2520" y="900" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-214" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;static struct kobj_type dynamic_kobj_ktype&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&#x9;.&lt;font color=&quot;#ff3333&quot;&gt;release&lt;/font&gt;&#x9;= dynamic_kobj_release,&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&#x9;.&lt;font color=&quot;#ff3333&quot;&gt;sysfs_ops&lt;/font&gt;&#x9;= &amp;amp;kobj_sysfs_ops,&lt;/p&gt;&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="3080" y="760" width="280" height="60" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-215" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="3080" y="776" width="280" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-216" value="&lt;b style=&quot;color: rgb(0 , 0 , 0)&quot;&gt;lib/kobject.c&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#FF3333;" vertex="1" parent="1">
          <mxGeometry x="3080" y="740" width="140" height="20" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-217" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;const struct sysfs_ops kobj_sysfs_ops&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;.&lt;font color=&quot;#ff3333&quot;&gt;show&lt;/font&gt;&lt;span&gt;&#x9;&lt;/span&gt;= kobj_attr_show,&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;.&lt;font color=&quot;#ff3333&quot;&gt;store&lt;/font&gt;&lt;span&gt;&#x9;&lt;/span&gt;= kobj_attr_store,&lt;/p&gt;&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="3440" y="760" width="280" height="60" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-218" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="3440" y="776" width="280" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-219" value="&lt;b style=&quot;color: rgb(0 , 0 , 0)&quot;&gt;lib/kobject.c&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#FF3333;" vertex="1" parent="1">
          <mxGeometry x="3440" y="740" width="140" height="20" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-220" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;static void &lt;font color=&quot;#3333ff&quot;&gt;kobject_init_internal&lt;/font&gt;(struct kobject *&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;)&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;if (!&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;)&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;return;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;/*将kobject的引用计数设置为1*/&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#3333ff&quot;&gt;kref_init&lt;/font&gt;(&amp;amp;&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;kref&lt;/font&gt;);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;/*初始化链表节点*/&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;INIT_LIST_HEAD(&amp;amp;&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;entry&lt;/font&gt;);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;/*该kobject对象还没和sysfs目录项关联*/&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;state_in_sysfs&lt;/font&gt; = 0;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;state_add_uevent_sent&lt;/font&gt; = 0;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;state_remove_uevent_sent&lt;/font&gt; = 0;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;/*kobject对象的初始化标志*/&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;state_initialized&lt;/font&gt; = 1;&lt;/p&gt;&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="3080" y="920" width="401" height="240" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-221" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="3080" y="936" width="401" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-222" value="&lt;b&gt;lib/kobject.c&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="3080" y="900" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-223" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;int &lt;font color=&quot;#3333ff&quot;&gt;kobject_add&lt;/font&gt;(struct kobject *&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;, struct kobject *&lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;,const char *&lt;font color=&quot;#ff3333&quot;&gt;fmt&lt;/font&gt;, ...)&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;va_list &lt;font color=&quot;#ff3333&quot;&gt;args&lt;/font&gt;;&lt;br&gt;int &lt;font color=&quot;#ff3333&quot;&gt;retval&lt;/font&gt;;&lt;/blockquote&gt;&lt;span&gt;...&lt;/span&gt;&lt;br&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;/*获取第一个可变参数，可变参数函数的实现与函数传参的栈结构有关*/&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#3333ff&quot;&gt;va_start&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;args&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;fmt&lt;/font&gt;);&lt;br&gt;&lt;font color=&quot;#ff3333&quot;&gt;retval&lt;/font&gt; = &lt;font color=&quot;#3333ff&quot;&gt;kobject_add_varg&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;fmt&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;args&lt;/font&gt;);&lt;br&gt;&lt;font color=&quot;#3333ff&quot;&gt;va_end&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;args&lt;/font&gt;);&lt;/blockquote&gt;&lt;br&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;return &lt;font color=&quot;#ff3333&quot;&gt;retval&lt;/font&gt;;&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="1960" y="1280" width="480" height="150" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-224" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="1960" y="1296" width="480" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-225" value="&lt;b&gt;lib/kobject.c&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="1960" y="1260" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-226" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;static __printf(3, 0) int &lt;font color=&quot;#3333ff&quot;&gt;kobject_add_varg&lt;/font&gt;(struct kobject *&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;,&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; struct kobject *&lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;,&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&amp;nbsp;      &lt;/span&gt;const char *&lt;font color=&quot;#ff3333&quot;&gt;fmt&lt;/font&gt;, va_list &lt;font color=&quot;#ff3333&quot;&gt;vargs&lt;/font&gt;)&lt;/b&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;int &lt;font color=&quot;#ff3333&quot;&gt;retval&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;retval &lt;/font&gt;= &lt;font color=&quot;#3333ff&quot;&gt;kobject_set_name_vargs&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;fmt&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;vargs&lt;/font&gt;);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;if (&lt;font color=&quot;#ff3333&quot;&gt;retval&lt;/font&gt;) {&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#3333ff&quot;&gt;pr_err&lt;/font&gt;(&quot;kobject: can not set name properly!\n&quot;);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;return &lt;font color=&quot;#ff3333&quot;&gt;retval&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;}&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;/*第一次设置kobj的parent指针*/&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;parent &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;return &lt;font color=&quot;#3333ff&quot;&gt;kobject_add_internal&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;);&lt;/p&gt;&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="2520" y="1280" width="480" height="220" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-227" value="&lt;b&gt;lib/kobject.c&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="2520" y="1260" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-228" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="2520" y="1333" width="480" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-229" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;int &lt;font color=&quot;#3333ff&quot;&gt;kobject_set_name_vargs&lt;/font&gt;(struct kobject *&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;, const char *&lt;font color=&quot;#ff3333&quot;&gt;fmt&lt;/font&gt;,&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; va_list &lt;font color=&quot;#ff3333&quot;&gt;vargs&lt;/font&gt;)&lt;/b&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;const char *&lt;font color=&quot;#ff3333&quot;&gt;s&lt;/font&gt;;&lt;/p&gt;&lt;/blockquote&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;b&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&#x9;...&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;/*参数格式化打印到s字符串中*/&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;s &lt;/font&gt;= &lt;font color=&quot;#3333ff&quot;&gt;kvasprintf_const&lt;/font&gt;(GFP_KERNEL, &lt;font color=&quot;#ff3333&quot;&gt;fmt&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;vargs&lt;/font&gt;);&lt;/p&gt;&lt;/blockquote&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;...&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;/*设置kobject对象的名称*/&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;name &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;s&lt;/font&gt;;&lt;/p&gt;&lt;/blockquote&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&#x9;...&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="3080" y="1280" width="401" height="190" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-230" value="&lt;b&gt;lib/kobject.c&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="3080" y="1260" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-231" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="3080" y="1314" width="401" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-232" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;static int &lt;font color=&quot;#3333ff&quot;&gt;kobject_add_internal&lt;/font&gt;(struct kobject *&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;)&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;struct kobject *&lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;span&gt;&#x9;&lt;/span&gt;...&lt;/div&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;&lt;font color=&quot;#ff3333&quot;&gt;parent &lt;/font&gt;= &lt;font color=&quot;#3333ff&quot;&gt;kobject_get&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;);&lt;/div&gt;&lt;div&gt;if (&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;kset&lt;/font&gt;) {&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;&lt;font color=&quot;#999999&quot;&gt;/*如果parent为空，parent设置为kobj-&amp;gt;kset-&amp;gt;kobj*/&lt;/font&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;if (!&lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;)&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#ff3333&quot;&gt;parent &lt;/font&gt;= &lt;font color=&quot;#3333ff&quot;&gt;kobject_get&lt;/font&gt;(&amp;amp;&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;kset&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;);&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;&lt;font color=&quot;#999999&quot;&gt;/*把该kobject加入到kset链表的末尾*/&lt;/font&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;&lt;font color=&quot;#3333ff&quot;&gt;kobj_kset_join&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;);&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;&lt;font color=&quot;#999999&quot;&gt;/*第二次设置kobj的parent指针*/&lt;/font&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;parent &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;;&lt;/div&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;}&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&#x9;&lt;/span&gt;...&lt;/div&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;&lt;font color=&quot;#ff3333&quot;&gt;error &lt;/font&gt;= &lt;font color=&quot;#3333ff&quot;&gt;create_dir&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;);&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;span&gt;&#x9;&lt;/span&gt;...&lt;/div&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;state_in_sysfs &lt;/font&gt;= 1;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;span&gt;&#x9;&lt;/span&gt;...&lt;/div&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="3080" y="1520" width="401" height="270" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-233" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="3080" y="1536" width="401" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-234" value="&lt;b&gt;lib/kobject.c&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="3080" y="1500" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-235" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;static int &lt;font color=&quot;#3333ff&quot;&gt;create_dir&lt;/font&gt;(struct kobject *&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;)&lt;/b&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;const struct kobj_ns_type_operations *&lt;font color=&quot;#ff3333&quot;&gt;ops&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;int &lt;font color=&quot;#ff3333&quot;&gt;error&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;error &lt;/font&gt;= &lt;font color=&quot;#3333ff&quot;&gt;sysfs_create_dir_ns&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;, &lt;font color=&quot;#3333ff&quot;&gt;kobject_namespace&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;));&lt;/p&gt;&lt;/blockquote&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&#x9;...&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="3560" y="1520" width="400" height="110" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-236" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="3560" y="1536" width="400" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-237" value="&lt;b&gt;lib/kobject.c&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="3560" y="1500" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-238" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;int &lt;font color=&quot;#3333ff&quot;&gt;sysfs_create_dir_ns&lt;/font&gt;(struct kobject *&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;, const void *&lt;font color=&quot;#ff3333&quot;&gt;ns&lt;/font&gt;)&lt;/b&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&#x9;struct kernfs_node *&lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;, *&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;kuid_t &lt;font color=&quot;#ff3333&quot;&gt;uid&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;kgid_t &lt;font color=&quot;#ff3333&quot;&gt;gid&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;BUG_ON(!&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;if (&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;)&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;/*获取上一层节点的目录项*/&lt;/font&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;parent &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;sd&lt;/font&gt;;&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;else&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;/*设置上一层节点的目录项为sysfs根目录*/&lt;/font&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;parent &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;sysfs_root_kn&lt;/font&gt;;&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;if (!&lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;)&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;return -ENOENT;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;kn &lt;/font&gt;= &lt;font color=&quot;#3333ff&quot;&gt;kernfs_create_dir_ns&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;, &lt;font color=&quot;#3333ff&quot;&gt;kobject_name&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;),&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; &amp;nbsp;S_IRWXU | S_IRUGO | S_IXUGO, &lt;font color=&quot;#ff3333&quot;&gt;uid&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;gid&lt;/font&gt;,&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; &amp;nbsp;&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;ns&lt;/font&gt;);&lt;/p&gt;&lt;/blockquote&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;...&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;/*kobj对象关联sysfs目录项*/&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;sd &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&#x9;return 0;&lt;/p&gt;&lt;/blockquote&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="4040" y="1520" width="460" height="430" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-239" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="4040" y="1536" width="460" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-240" value="&lt;b&gt;fs/sysfs/dir.c&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="4040" y="1500" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-241" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;struct kernfs_node *&lt;font color=&quot;#3333ff&quot;&gt;kernfs_create_dir_ns&lt;/font&gt;(struct kernfs_node *&lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;,&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt; &lt;/span&gt; &lt;/span&gt;&amp;nbsp; const char *&lt;font color=&quot;#ff3333&quot;&gt;name&lt;/font&gt;, umode_t &lt;font color=&quot;#ff3333&quot;&gt;mode&lt;/font&gt;,&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;&lt;span&gt;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/span&gt; &lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;kuid_t &lt;font color=&quot;#ff3333&quot;&gt;uid&lt;/font&gt;, kgid_t &lt;font color=&quot;#ff3333&quot;&gt;gid&lt;/font&gt;,&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;&#x9;&#x9;&#x9;&#x9;&#x9; &lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; void *&lt;font color=&quot;#ff3333&quot;&gt;priv&lt;/font&gt;, const void *&lt;font color=&quot;#ff3333&quot;&gt;ns&lt;/font&gt;)&lt;/b&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;struct kernfs_node *&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;int &lt;font color=&quot;#ff3333&quot;&gt;rc&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;/* allocate */&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;kn &lt;/font&gt;= &lt;font color=&quot;#3333ff&quot;&gt;kernfs_new_node&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;name&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;mode &lt;/font&gt;| S_IFDIR,&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; uid&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;gid&lt;/font&gt;, KERNFS_DIR);&lt;/p&gt;&lt;/blockquote&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;...&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;/*sysfs目录项关联kobject对象*/&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;priv &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;priv&lt;/font&gt;;&lt;/p&gt;&lt;/blockquote&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&#x9;...&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="4600" y="1520" width="500" height="260" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-242" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="4600" y="1591" width="500" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-243" value="&lt;b&gt;fs/kernfs/dir.c&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="4600" y="1500" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-244" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;struct kernfs_node *&lt;font color=&quot;#3333ff&quot;&gt;kernfs_new_node&lt;/font&gt;(struct kernfs_node *&lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;,&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; const char *&lt;font color=&quot;#ff3333&quot;&gt;name&lt;/font&gt;, umode_t &lt;font color=&quot;#ff3333&quot;&gt;mode&lt;/font&gt;,&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp;kuid_t &lt;font color=&quot;#ff3333&quot;&gt;uid&lt;/font&gt;, kgid_t &lt;font color=&quot;#ff3333&quot;&gt;gid&lt;/font&gt;,&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; unsigned &lt;font color=&quot;#ff3333&quot;&gt;flags&lt;/font&gt;)&lt;/b&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;struct kernfs_node *&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;kn &lt;/font&gt;= &lt;font color=&quot;#3333ff&quot;&gt;__kernfs_new_node&lt;/font&gt;(&lt;font color=&quot;#3333ff&quot;&gt;kernfs_root&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;),&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; &lt;font color=&quot;#ff3333&quot;&gt;name&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;mode&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;uid&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;gid&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;flags&lt;/font&gt;);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;if (&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;) {&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#3333ff&quot;&gt;kernfs_get&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;);&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;parent &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;;&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;}&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;return &lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;;&lt;/p&gt;&lt;/blockquote&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="5200" y="1520" width="480" height="240" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-245" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="5200" y="1591" width="480" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-246" value="&lt;b&gt;fs/kernfs/dir.c&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="5200" y="1500" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-247" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;int &lt;font color=&quot;#3333ff&quot;&gt;sysfs_create_group&lt;/font&gt;(struct kobject *&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;,&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;/span&gt;const struct attribute_group *&lt;font color=&quot;#ff3333&quot;&gt;grp&lt;/font&gt;)&lt;/b&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;return &lt;font color=&quot;#3333ff&quot;&gt;internal_create_group&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;, 0, &lt;font color=&quot;#ff3333&quot;&gt;grp&lt;/font&gt;);&lt;/p&gt;&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="1360" y="2121" width="440" height="60" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-248" value="&lt;b&gt;fs/sysfs/group.c&lt;br&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="1360" y="2101" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-249" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="1360" y="2155" width="440" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-250" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;struct attribute_group&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&#x9;const char&#x9;&#x9;*&lt;font color=&quot;#ff3333&quot;&gt;name&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;umode_t&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;(*&lt;font color=&quot;#ff3333&quot;&gt;is_visible&lt;/font&gt;)(struct kobject *,&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; &amp;nbsp;struct attribute *, int);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;umode_t&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;(*&lt;font color=&quot;#ff3333&quot;&gt;is_bin_visible&lt;/font&gt;)(struct kobject *,&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp;struct bin_attribute *, int);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;struct attribute&lt;span&gt;&#x9;&lt;/span&gt;**&lt;font color=&quot;#ff3333&quot;&gt;attrs&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&#x9;struct bin_attribute&#x9;**&lt;font color=&quot;#ff3333&quot;&gt;bin_attrs&lt;/font&gt;;&lt;/p&gt;&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="920" y="2121" width="360" height="150" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-251" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="920" y="2137" width="360" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-252" value="&lt;b style=&quot;color: rgb(0 , 0 , 0)&quot;&gt;include/linux/sysfs.h&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#FF3333;" vertex="1" parent="1">
          <mxGeometry x="920" y="2101" width="140" height="20" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-253" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;struct attribute&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;const char&lt;span&gt;&#x9;&#x9;&lt;/span&gt;*&lt;font color=&quot;#ff3333&quot;&gt;name&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;umode_t&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;font color=&quot;#ff3333&quot;&gt;mode&lt;/font&gt;;&lt;/p&gt;&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="640" y="2120" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-254" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="640" y="2136" width="200" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-255" value="&lt;b style=&quot;color: rgb(0 , 0 , 0)&quot;&gt;include/linux/sysfs.h&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#FF3333;" vertex="1" parent="1">
          <mxGeometry x="640" y="2100" width="140" height="20" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-256" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;struct kobj_attribute&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&#x9;struct attribute &lt;font color=&quot;#ff3333&quot;&gt;attr&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;ssize_t (*&lt;font color=&quot;#ff3333&quot;&gt;show&lt;/font&gt;)(struct kobject *kobj, struct kobj_attribute *attr,&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; char *buf);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;ssize_t (*&lt;font color=&quot;#ff3333&quot;&gt;store&lt;/font&gt;)(struct kobject *kobj, struct kobj_attribute *attr,&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&#x9;&#x9;&#x9; &lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; const char *buf, size_t &lt;font color=&quot;#ff3333&quot;&gt;count&lt;/font&gt;);&lt;/p&gt;&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="160" y="2120" width="400" height="120" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-257" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="160" y="2136" width="400" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-258" value="&lt;b style=&quot;color: rgb(0 , 0 , 0)&quot;&gt;include/linux/kobject.h&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#FF3333;" vertex="1" parent="1">
          <mxGeometry x="160" y="2100" width="140" height="20" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-259" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;static int &lt;font color=&quot;#3333ff&quot;&gt;internal_create_group&lt;/font&gt;(struct kobject *&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;, int &lt;font color=&quot;#ff3333&quot;&gt;update&lt;/font&gt;,&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;&lt;span&gt;&#x9;&#x9;&#x9;&#x9;&lt;/span&gt; &lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt; &lt;/span&gt;&amp;nbsp; const struct attribute_group *&lt;font color=&quot;#ff3333&quot;&gt;grp&lt;/font&gt;)&lt;/b&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;struct kernfs_node *&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;;&lt;br&gt;kuid_t &lt;font color=&quot;#ff3333&quot;&gt;uid&lt;/font&gt;;&lt;br&gt;kgid_t &lt;font color=&quot;#ff3333&quot;&gt;gid&lt;/font&gt;;&lt;br&gt;int &lt;font color=&quot;#ff3333&quot;&gt;error&lt;/font&gt;;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;span&gt;...&lt;/span&gt;&lt;br&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;if (&lt;font color=&quot;#ff3333&quot;&gt;grp&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;name&lt;/font&gt;)&lt;/blockquote&gt;&lt;span&gt;...&lt;/span&gt;&lt;br&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;else&lt;br&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;kn &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;sd&lt;/font&gt;;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;span&gt;...&lt;/span&gt;&lt;br&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;error &lt;/font&gt;= &lt;font color=&quot;#3333ff&quot;&gt;create_files&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;uid&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;gid&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;grp&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;update&lt;/font&gt;);&lt;/blockquote&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;...&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="1880" y="2121" width="440" height="220" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-260" value="&lt;b&gt;fs/sysfs/group.c&lt;br&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="1880" y="2101" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-261" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="1880" y="2154" width="440" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-262" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;static int &lt;font color=&quot;#3333ff&quot;&gt;create_files&lt;/font&gt;(struct kernfs_node *&lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;, struct kobject *&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;,&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;kuid_t &lt;font color=&quot;#ff3333&quot;&gt;uid&lt;/font&gt;, kgid_t &lt;font color=&quot;#ff3333&quot;&gt;gid&lt;/font&gt;,&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;const struct attribute_group *&lt;font color=&quot;#ff3333&quot;&gt;grp&lt;/font&gt;, int &lt;font color=&quot;#ff3333&quot;&gt;update&lt;/font&gt;)&lt;/b&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;struct attribute *const *&lt;font color=&quot;#ff3333&quot;&gt;attr&lt;/font&gt;;&lt;br&gt;struct bin_attribute *const *&lt;font color=&quot;#ff3333&quot;&gt;bin_attr&lt;/font&gt;;&lt;br&gt;int &lt;font color=&quot;#ff3333&quot;&gt;error &lt;/font&gt;= 0, &lt;font color=&quot;#ff3333&quot;&gt;i&lt;/font&gt;;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;br&gt;&lt;/blockquote&gt;if (&lt;font color=&quot;#ff3333&quot;&gt;grp&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;attrs&lt;/font&gt;) {&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;for (&lt;font color=&quot;#ff3333&quot;&gt;i&lt;/font&gt; = 0, &lt;font color=&quot;#ff3333&quot;&gt;attr &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;grp&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;attrs&lt;/font&gt;; *&lt;font color=&quot;#ff3333&quot;&gt;attr &lt;/font&gt;&amp;amp;&amp;amp; !&lt;font color=&quot;#ff3333&quot;&gt;error&lt;/font&gt;; &lt;font color=&quot;#ff3333&quot;&gt;i&lt;/font&gt;++, &lt;font color=&quot;#ff3333&quot;&gt;attr&lt;/font&gt;++) {&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;umode_t &lt;font color=&quot;#ff3333&quot;&gt;mode &lt;/font&gt;= (*&lt;font color=&quot;#ff3333&quot;&gt;attr&lt;/font&gt;)-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;mode&lt;/font&gt;;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;span&gt;...&lt;/span&gt;&lt;br&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;error &lt;/font&gt;= &lt;font color=&quot;#3333ff&quot;&gt;sysfs_add_file_mode_ns&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;, *&lt;font color=&quot;#ff3333&quot;&gt;attr&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;false&lt;/font&gt;,&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;mode&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;uid&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;gid&lt;/font&gt;, NULL);&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;span&gt;...&lt;/span&gt;&lt;br&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;}&lt;/span&gt;&lt;/blockquote&gt;...&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="2401" y="2121" width="440" height="250" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-263" value="&lt;b&gt;fs/sysfs/group.c&lt;br&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="2401" y="2101" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-264" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="2401" y="2172" width="440" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-265" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;int &lt;font color=&quot;#3333ff&quot;&gt;sysfs_add_file_mode_ns&lt;/font&gt;(struct kernfs_node *&lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;,&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; &amp;nbsp; const struct attribute *&lt;font color=&quot;#ff3333&quot;&gt;attr&lt;/font&gt;, bool &lt;font color=&quot;#ff3333&quot;&gt;is_bin&lt;/font&gt;,&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; &amp;nbsp;umode_t &lt;font color=&quot;#ff3333&quot;&gt;mode&lt;/font&gt;, kuid_t &lt;font color=&quot;#ff3333&quot;&gt;uid&lt;/font&gt;, kgid_t &lt;font color=&quot;#ff3333&quot;&gt;gid&lt;/font&gt;,&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;const void *&lt;font color=&quot;#ff3333&quot;&gt;ns&lt;/font&gt;)&lt;/b&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;struct lock_class_key *&lt;font color=&quot;#ff3333&quot;&gt;key &lt;/font&gt;= NULL;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;const struct kernfs_ops *&lt;font color=&quot;#ff3333&quot;&gt;ops&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;struct kernfs_node *&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;loff_t &lt;font color=&quot;#ff3333&quot;&gt;size&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;if (!&lt;font color=&quot;#ff3333&quot;&gt;is_bin&lt;/font&gt;) {&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;struct kobject *&lt;font color=&quot;#ff3333&quot;&gt;kobj &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;priv&lt;/font&gt;;&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;/*kobj_sysfs_ops*/&lt;/font&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;const struct sysfs_ops *&lt;font color=&quot;#ff3333&quot;&gt;sysfs_ops &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;ktype&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;sysfs_ops&lt;/font&gt;;&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&lt;/span&gt;...&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;if (&lt;font color=&quot;#ff3333&quot;&gt;sysfs_ops&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;show &lt;/font&gt;&amp;amp;&amp;amp; &lt;font color=&quot;#ff3333&quot;&gt;sysfs_ops&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;store&lt;/font&gt;) {&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;if (&lt;font color=&quot;#ff3333&quot;&gt;mode &lt;/font&gt;&amp;amp; SYSFS_PREALLOC)&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;ops &lt;/font&gt;= &amp;amp;sysfs_prealloc_kfops_rw;&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;else&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;ops &lt;/font&gt;= &amp;amp;sysfs_file_kfops_rw;&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;else if&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;...&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;}&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;...&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;kn &lt;/font&gt;= &lt;font color=&quot;#3333ff&quot;&gt;__kernfs_create_file&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;attr&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;name&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;mode &lt;/font&gt;&amp;amp; 0777, &lt;font color=&quot;#ff3333&quot;&gt;uid&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;gid&lt;/font&gt;,&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; &lt;font color=&quot;#ff3333&quot;&gt;size&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;ops&lt;/font&gt;, (void *)&lt;font color=&quot;#ff3333&quot;&gt;attr&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;ns&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;key&lt;/font&gt;);&lt;/p&gt;&lt;/blockquote&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;...&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="2920" y="2121" width="470" height="480" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-266" value="&lt;b&gt;fs/sysfs/file.c&lt;br&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="2920" y="2101" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-267" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="2920" y="2191" width="470" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-268" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;static const struct kernfs_ops sysfs_file_kfops_rw&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;.&lt;font color=&quot;#ff3333&quot;&gt;seq_show&lt;/font&gt;&lt;font color=&quot;#ff3333&quot;&gt;&#x9;&lt;/font&gt;= sysfs_kf_seq_show,&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;.&lt;font color=&quot;#ff3333&quot;&gt;write&lt;span&gt;&#x9;&#x9;&lt;/span&gt;&lt;/font&gt;= sysfs_kf_write,&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="3480" y="2121" width="360" height="60" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-269" value="&lt;b&gt;fs/sysfs/file.c&lt;br&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="3480" y="2101" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-270" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="3480" y="2136" width="360" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-271" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;struct kernfs_node *&lt;font color=&quot;#3333ff&quot;&gt;__kernfs_create_file&lt;/font&gt;(struct kernfs_node *&lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;,&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;&lt;span&gt;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/span&gt; &lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;const char *&lt;font color=&quot;#ff3333&quot;&gt;name&lt;/font&gt;,&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;&lt;span&gt;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/span&gt; &lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt; &lt;/span&gt;umode_t &lt;font color=&quot;#ff3333&quot;&gt;mode&lt;/font&gt;, kuid_t &lt;font color=&quot;#ff3333&quot;&gt;uid&lt;/font&gt;, kgid_t &lt;font color=&quot;#ff3333&quot;&gt;gid&lt;/font&gt;,&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;&lt;span&gt;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/span&gt; &lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt; &lt;/span&gt;&amp;nbsp;loff_t &lt;font color=&quot;#ff3333&quot;&gt;size&lt;/font&gt;,&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;&lt;span&gt;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/span&gt; &lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; &amp;nbsp;const struct kernfs_ops *&lt;font color=&quot;#ff3333&quot;&gt;ops&lt;/font&gt;,&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;&lt;span&gt;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/span&gt; &lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; &amp;nbsp; void *&lt;font color=&quot;#ff3333&quot;&gt;priv&lt;/font&gt;, const void *&lt;font color=&quot;#ff3333&quot;&gt;ns&lt;/font&gt;,&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;&lt;span&gt;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/span&gt; &lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;struct lock_class_key *&lt;font color=&quot;#ff3333&quot;&gt;key&lt;/font&gt;)&lt;/b&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;struct kernfs_node *&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;;&lt;br&gt;unsigned &lt;font color=&quot;#ff3333&quot;&gt;flags&lt;/font&gt;;&lt;br&gt;int &lt;font color=&quot;#ff3333&quot;&gt;rc&lt;/font&gt;;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;font color=&quot;#ff3333&quot;&gt;flags &lt;/font&gt;= KERNFS_FILE;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;font color=&quot;#ff3333&quot;&gt;kn &lt;/font&gt;= &lt;font color=&quot;#3333ff&quot;&gt;kernfs_new_node&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;name&lt;/font&gt;, (&lt;font color=&quot;#ff3333&quot;&gt;mode &lt;/font&gt;&amp;amp; S_IALLUGO) | S_IFREG,&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;font color=&quot;#ff3333&quot;&gt;uid&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;gid&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;flags&lt;/font&gt;);&lt;br&gt;if (!&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;)&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;return ERR_PTR(-ENOMEM);&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;/*操作接口赋值*/&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;attr&lt;/font&gt;.&lt;font color=&quot;#ff3333&quot;&gt;ops &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;ops&lt;/font&gt;;&lt;br&gt;&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;attr&lt;/font&gt;.&lt;font color=&quot;#ff3333&quot;&gt;size &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;size&lt;/font&gt;;&lt;br&gt;&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;ns &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;ns&lt;/font&gt;;&lt;br&gt;&lt;font color=&quot;#999999&quot;&gt;/*文件属性赋值*/&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;priv &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;priv&lt;/font&gt;;&lt;br&gt;if (&lt;font color=&quot;#ff3333&quot;&gt;ops&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;seq_show&lt;/font&gt;)&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;flags &lt;/font&gt;|= KERNFS_HAS_SEQ_SHOW;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;...&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="3480" y="2241" width="560" height="410" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-272" value="&lt;b&gt;fs/sysfs/file.c&lt;br&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="3480" y="2221" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-273" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="3480" y="2366" width="560" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-274" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;static void &lt;font color=&quot;#3333ff&quot;&gt;kernfs_init_inode&lt;/font&gt;(struct kernfs_node *&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;, struct inode *&lt;font color=&quot;#ff3333&quot;&gt;inode&lt;/font&gt;)&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#3333ff&quot;&gt;kernfs_get&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;/*sysfs的kernels_node赋值给vfs的inode*/&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#ff3333&quot;&gt;inode&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;i_private &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#ff3333&quot;&gt;inode&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;i_mapping&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;a_ops &lt;/font&gt;= &amp;amp;kernfs_aops;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#ff3333&quot;&gt;inode&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;i_op &lt;/font&gt;= &amp;amp;kernfs_iops;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#ff3333&quot;&gt;inode&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;i_generation &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;id&lt;/font&gt;.&lt;font color=&quot;#ff3333&quot;&gt;generation&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#3333ff&quot;&gt;set_default_inode_attr&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;inode&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;mode&lt;/font&gt;);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#3333ff&quot;&gt;kernfs_refresh_inode&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;inode&lt;/font&gt;);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;/* 判断sysfs的kernels_node类型 */&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#3333ff&quot;&gt;switch &lt;/font&gt;(&lt;font color=&quot;#3333ff&quot;&gt;kernfs_type&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;)) {&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;case KERNFS_DIR:&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;inode&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;i_op &lt;/font&gt;= &amp;amp;kernfs_dir_iops;&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;inode&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;i_fop &lt;/font&gt;= &amp;amp;kernfs_dir_fops;&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;if (&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;flags &lt;/font&gt;&amp;amp; KERNFS_EMPTY_DIR)&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#3333ff&quot;&gt;make_empty_dir_inode&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;inode&lt;/font&gt;);&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;break;&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;case KERNFS_FILE:&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;inode&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;i_size &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;attr&lt;/font&gt;.&lt;font color=&quot;#ff3333&quot;&gt;size&lt;/font&gt;;&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;/*文件的操作接口*/&lt;/font&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;inode&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;i_fop &lt;/font&gt;= &amp;amp;kernfs_file_fops;&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;break;&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;case KERNFS_LINK:&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;inode&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;i_op &lt;/font&gt;= &amp;amp;kernfs_symlink_iops;&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;break;&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;default:&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#3333ff&quot;&gt;BUG&lt;/font&gt;();&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;}&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#3333ff&quot;&gt;unlock_new_inode&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;inode&lt;/font&gt;);&lt;/p&gt;&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="1360" y="2800" width="480" height="590" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-275" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="1360" y="2816" width="480" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-276" value="&lt;b&gt;fs/kernfs/inode.c&lt;br&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="1360" y="2780" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-277" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;const struct file_operations kernfs_file_fops&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;.&lt;font color=&quot;#ff3333&quot;&gt;read&lt;span&gt;&#x9;&#x9;&lt;/span&gt;&lt;/font&gt;= kernfs_fop_read,&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;.&lt;font color=&quot;#ff3333&quot;&gt;write&lt;span&gt;&#x9;&#x9;&lt;/span&gt;&lt;/font&gt;= kernfs_fop_write,&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;.&lt;font color=&quot;#ff3333&quot;&gt;llseek&lt;span&gt;&#x9;&#x9;&lt;/span&gt;&lt;/font&gt;= generic_file_llseek,&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;.&lt;font color=&quot;#ff3333&quot;&gt;mmap&lt;span&gt;&#x9;&#x9;&lt;/span&gt;&lt;/font&gt;= kernfs_fop_mmap,&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;.&lt;font color=&quot;#ff3333&quot;&gt;open&lt;span&gt;&#x9;&#x9;&lt;/span&gt;&lt;/font&gt;= kernfs_fop_open,&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;.&lt;font color=&quot;#ff3333&quot;&gt;release&lt;span&gt;&#x9;&lt;/span&gt;&lt;/font&gt;= kernfs_fop_release,&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;.&lt;font color=&quot;#ff3333&quot;&gt;poll&lt;span&gt;&#x9;&#x9;&lt;/span&gt;&lt;/font&gt;= kernfs_fop_poll,&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;.&lt;font color=&quot;#ff3333&quot;&gt;fsync&lt;span&gt;&#x9;&#x9;&lt;/span&gt;&lt;/font&gt;= noop_fsync,&lt;/p&gt;&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="1920" y="2800" width="280" height="170" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-278" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="1920" y="2816" width="280" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-279" value="&lt;b&gt;fs/kernfs/file.c&lt;br&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="1920" y="2780" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-280" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;static int &lt;font color=&quot;#3333ff&quot;&gt;kernfs_fop_open&lt;/font&gt;(struct inode *&lt;font color=&quot;#ff3333&quot;&gt;inode&lt;/font&gt;, struct file *&lt;font color=&quot;#ff3333&quot;&gt;file&lt;/font&gt;)&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;struct kernfs_node *&lt;font color=&quot;#ff3333&quot;&gt;kn &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;inode&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;i_private&lt;/font&gt;;&lt;br&gt;struct kernfs_open_file *&lt;font color=&quot;#ff3333&quot;&gt;of&lt;/font&gt;;&lt;/blockquote&gt;&lt;span&gt;...&lt;/span&gt;&lt;br&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;of &lt;/font&gt;= &lt;font color=&quot;#3333ff&quot;&gt;kzalloc&lt;/font&gt;(sizeof(struct kernfs_open_file), GFP_KERNEL);&lt;/blockquote&gt;&lt;span&gt;...&lt;/span&gt;&lt;br&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;/*sysfs中文件的kernfs_node赋值给of-&amp;gt;kn*/&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#ff3333&quot;&gt;of&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;kn &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;;&lt;br&gt;&lt;font color=&quot;#999999&quot;&gt;/*进程的struct file赋值给of-&amp;gt;file/&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#ff3333&quot;&gt;of&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;file &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;file&lt;/font&gt;;&lt;/blockquote&gt;&lt;span&gt;...&lt;/span&gt;&lt;br&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;if (&lt;font color=&quot;#ff3333&quot;&gt;ops&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;seq_show&lt;/font&gt;)&lt;br&gt;&lt;font color=&quot;#ff3333&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;error &lt;/font&gt;= &lt;font color=&quot;#3333ff&quot;&gt;seq_open&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;file&lt;/font&gt;, &amp;amp;kernfs_seq_ops);&lt;/blockquote&gt;&lt;span&gt;...&lt;/span&gt;&lt;br&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;/*struct file的私有指针赋值给of-&amp;gt;seq_file */&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#ff3333&quot;&gt;of&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;seq_file &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;file&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;private_data&lt;/font&gt;;&lt;br&gt;&lt;font color=&quot;#999999&quot;&gt;/*of赋值给of-&amp;gt;seq_file-&amp;gt;private*/&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#ff3333&quot;&gt;of&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;seq_file&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;private &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;of&lt;/font&gt;;&lt;/blockquote&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;...&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="2280" y="2800" width="400" height="280" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-281" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="2280" y="2816" width="400" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-282" value="&lt;b&gt;fs/kernfs/file.c&lt;br&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="2280" y="2780" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-283" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;static const struct seq_operations kernfs_seq_ops&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;.&lt;font color=&quot;#ff3333&quot;&gt;start &lt;/font&gt;= kernfs_seq_start,&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;.&lt;font color=&quot;#ff3333&quot;&gt;next &lt;/font&gt;= kernfs_seq_next,&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;.&lt;font color=&quot;#ff3333&quot;&gt;stop &lt;/font&gt;= kernfs_seq_stop,&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;.&lt;font color=&quot;#ff3333&quot;&gt;show &lt;/font&gt;= kernfs_seq_show,&lt;/p&gt;&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="2760" y="2800" width="360" height="90" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-284" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="2760" y="2816" width="360" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-285" value="&lt;b&gt;fs/kernfs/file.c&lt;br&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="2760" y="2780" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-286" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;int &lt;font color=&quot;#3333ff&quot;&gt;seq_open&lt;/font&gt;(struct file *&lt;font color=&quot;#ff3333&quot;&gt;file&lt;/font&gt;, const struct seq_operations *&lt;font color=&quot;#ff3333&quot;&gt;op&lt;/font&gt;)&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;struct seq_file *&lt;font color=&quot;#ff3333&quot;&gt;p&lt;/font&gt;;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;br&gt;WARN_ON(&lt;font color=&quot;#ff3333&quot;&gt;file&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;private_data&lt;/font&gt;);&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;br&gt;&lt;font color=&quot;#ff3333&quot;&gt;p &lt;/font&gt;= &lt;font color=&quot;#3333ff&quot;&gt;kmem_cache_zalloc&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;seq_file_cache&lt;/font&gt;, GFP_KERNEL);&lt;br&gt;if (!&lt;font color=&quot;#ff3333&quot;&gt;p&lt;/font&gt;)&lt;br&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;return -ENOMEM;&lt;br&gt;&lt;font color=&quot;#ff3333&quot;&gt;file&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;private_data &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;p&lt;/font&gt;;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;span&gt;...&lt;/span&gt;&lt;br&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;p&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;op &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;op&lt;/font&gt;;&lt;/blockquote&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;...&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="2760" y="2960" width="400" height="190" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-287" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="2760" y="2976" width="400" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-288" value="&lt;b&gt;fs/seq_file.c&lt;br&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="2760" y="2938" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-289" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;static ssize_t &lt;font color=&quot;#3333ff&quot;&gt;kernfs_fop_read&lt;/font&gt;(struct file *&lt;font color=&quot;#ff3333&quot;&gt;file&lt;/font&gt;, char __user *&lt;font color=&quot;#ff3333&quot;&gt;user_buf&lt;/font&gt;,&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;size_t &lt;font color=&quot;#ff3333&quot;&gt;count&lt;/font&gt;, loff_t *&lt;font color=&quot;#ff3333&quot;&gt;ppos&lt;/font&gt;)&lt;/b&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;struct kernfs_open_file *&lt;font color=&quot;#ff3333&quot;&gt;of &lt;/font&gt;= &lt;font color=&quot;#3333ff&quot;&gt;kernfs_of&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;file&lt;/font&gt;);&lt;br&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;br&gt;&lt;/blockquote&gt;if (&lt;font color=&quot;#ff3333&quot;&gt;of&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;flags &lt;/font&gt;&amp;amp; KERNFS_HAS_SEQ_SHOW)&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;return &lt;font color=&quot;#3333ff&quot;&gt;seq_read&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;file&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;user_buf&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;count&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;ppos&lt;/font&gt;);&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;else&lt;br&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;return &lt;font color=&quot;#3333ff&quot;&gt;kernfs_file_direct_read&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;of&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;user_buf&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;count&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;ppos&lt;/font&gt;);&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="2280" y="3200" width="440" height="130" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-290" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="2280" y="3233" width="440" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-291" value="&lt;b&gt;fs/kernfs/file.c&lt;br&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="2280" y="3180" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-292" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;static struct kernfs_open_file *&lt;font color=&quot;#3333ff&quot;&gt;kernfs_of&lt;/font&gt;(struct file *&lt;font color=&quot;#ff3333&quot;&gt;file&lt;/font&gt;)&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;return ((struct seq_file *)&lt;font color=&quot;#ff3333&quot;&gt;file&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;private_data&lt;/font&gt;)-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;private&lt;/font&gt;;&lt;br&gt;&lt;/p&gt;&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="2800" y="3200" width="360" height="40" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-293" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="2800" y="3216" width="360" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-294" value="&lt;b&gt;fs/kernfs/file.c&lt;br&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="2800" y="3180" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-295" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;ssize_t &lt;font color=&quot;#3333ff&quot;&gt;seq_read&lt;/font&gt;(struct file *&lt;font color=&quot;#ff3333&quot;&gt;file&lt;/font&gt;, char __user *&lt;font color=&quot;#ff3333&quot;&gt;buf&lt;/font&gt;, size_t &lt;font color=&quot;#ff3333&quot;&gt;size&lt;/font&gt;, loff_t *&lt;font color=&quot;#ff3333&quot;&gt;ppos&lt;/font&gt;)&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;struct seq_file *&lt;font color=&quot;#ff3333&quot;&gt;m &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;file&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;private_data&lt;/font&gt;;&lt;/blockquote&gt;&lt;span&gt;...&lt;/span&gt;&lt;br&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;err &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;m&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;op&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#3333ff&quot;&gt;show&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;m&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;p&lt;/font&gt;);&lt;/blockquote&gt;&lt;span&gt;...&lt;/span&gt;&lt;br&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;err &lt;/font&gt;= &lt;font color=&quot;#3333ff&quot;&gt;copy_to_user&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;buf&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;m&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;buf&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;n&lt;/font&gt;);&lt;/blockquote&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;...&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="2800" y="3320" width="480" height="120" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-296" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="2800" y="3336" width="480" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-297" value="&lt;b&gt;fs/seq_file.c&lt;br&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="2800" y="3298" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-298" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;static int &lt;font color=&quot;#3333ff&quot;&gt;kernfs_seq_show&lt;/font&gt;(struct seq_file *&lt;font color=&quot;#ff3333&quot;&gt;sf&lt;/font&gt;, void *&lt;font color=&quot;#ff3333&quot;&gt;v&lt;/font&gt;)&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;struct kernfs_open_file *&lt;font color=&quot;#ff3333&quot;&gt;of &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;sf&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;private&lt;/font&gt;;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;span&gt;...&lt;/span&gt;&lt;br&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;return &lt;font color=&quot;#ff3333&quot;&gt;of&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;attr&lt;/font&gt;.&lt;font color=&quot;#ff3333&quot;&gt;ops&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#3333ff&quot;&gt;seq_show&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;sf&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;v&lt;/font&gt;);&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="3200" y="2800" width="480" height="70" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-299" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="3200" y="2815" width="480" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-300" value="&lt;b&gt;fs/kernfs/file.c&lt;br&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="3200" y="2780" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-301" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;static int &lt;font color=&quot;#3333ff&quot;&gt;sysfs_kf_seq_show&lt;/font&gt;(struct seq_file *&lt;font color=&quot;#ff3333&quot;&gt;sf&lt;/font&gt;, void *&lt;font color=&quot;#ff3333&quot;&gt;v&lt;/font&gt;)&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;struct kernfs_open_file *&lt;font color=&quot;#ff3333&quot;&gt;of &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;sf&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;private&lt;/font&gt;;&lt;/div&gt;&lt;div&gt;struct kobject *&lt;font color=&quot;#ff3333&quot;&gt;kobj &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;of&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;priv&lt;/font&gt;;&lt;/div&gt;&lt;div&gt;const struct sysfs_ops *&lt;font color=&quot;#ff3333&quot;&gt;ops &lt;/font&gt;= &lt;font color=&quot;#3333ff&quot;&gt;sysfs_file_ops&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;of&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;);&lt;/div&gt;&lt;div&gt;ssize_t &lt;font color=&quot;#ff3333&quot;&gt;count&lt;/font&gt;;&lt;/div&gt;&lt;div&gt;char *&lt;font color=&quot;#ff3333&quot;&gt;buf&lt;/font&gt;;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#ff3333&quot;&gt;count &lt;/font&gt;= &lt;font color=&quot;#3333ff&quot;&gt;seq_get_buf&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;sf&lt;/font&gt;, &amp;amp;&lt;font color=&quot;#ff3333&quot;&gt;buf&lt;/font&gt;);&lt;/div&gt;&lt;div&gt;if (&lt;font color=&quot;#ff3333&quot;&gt;count &lt;/font&gt;&amp;lt; PAGE_SIZE) {&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;&lt;font color=&quot;#3333ff&quot;&gt;seq_commit&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;sf&lt;/font&gt;, -1);&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;return 0;&lt;/div&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#3333ff&quot;&gt;memset&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;buf&lt;/font&gt;, 0, PAGE_SIZE);&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#999999&quot;&gt;/*&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#999999&quot;&gt; * Invoke show().&amp;nbsp; Control may reach here via seq file lseek even&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#999999&quot;&gt; * if @ops-&amp;gt;show() isn&#39;t implemented.&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#999999&quot;&gt; */&lt;/font&gt;&lt;/div&gt;&lt;div&gt;if (&lt;font color=&quot;#ff3333&quot;&gt;ops&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;show&lt;/font&gt;) {&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;&lt;font color=&quot;#ff3333&quot;&gt;count &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;ops&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#3333ff&quot;&gt;show&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;of&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;priv&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;buf&lt;/font&gt;);&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;if (&lt;font color=&quot;#ff3333&quot;&gt;count &lt;/font&gt;&amp;lt; 0)&lt;/div&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;return &lt;font color=&quot;#ff3333&quot;&gt;count&lt;/font&gt;;&lt;/div&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#999999&quot;&gt;/*&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#999999&quot;&gt; * The code works fine with PAGE_SIZE return but it&#39;s likely to&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#999999&quot;&gt; * indicate truncated result or overflow in normal use cases.&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#999999&quot;&gt; */&lt;/font&gt;&lt;/div&gt;&lt;div&gt;if (&lt;font color=&quot;#ff3333&quot;&gt;count &lt;/font&gt;&amp;gt;= (ssize_t)PAGE_SIZE) {&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;&lt;font color=&quot;#3333ff&quot;&gt;printk&lt;/font&gt;(&quot;fill_read_buffer: %pS returned bad count\n&quot;,&lt;/div&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;&lt;font color=&quot;#ff3333&quot;&gt;ops&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;show&lt;/font&gt;);&lt;/div&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;&lt;font color=&quot;#999999&quot;&gt;/* Try to struggle along */&lt;/font&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;&lt;font color=&quot;#ff3333&quot;&gt;count &lt;/font&gt;= PAGE_SIZE - 1;&lt;/div&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#3333ff&quot;&gt;seq_commit&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;sf&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;count&lt;/font&gt;);&lt;/div&gt;&lt;div&gt;return 0;&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="4120" y="2121" width="440" height="530" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-302" value="&lt;b&gt;fs/sysfs/file.c&lt;br&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="4120" y="2101" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-303" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="4120" y="2136" width="440" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-304" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;static ssize_t &lt;font color=&quot;#3333ff&quot;&gt;kobj_attr_show&lt;/font&gt;(struct kobject *&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;, struct attribute *&lt;font color=&quot;#ff3333&quot;&gt;attr&lt;/font&gt;,char *&lt;font color=&quot;#ff3333&quot;&gt;buf&lt;/font&gt;)&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;struct kobj_attribute *&lt;font color=&quot;#ff3333&quot;&gt;kattr&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;ssize_t &lt;font color=&quot;#ff3333&quot;&gt;ret &lt;/font&gt;= -EIO;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;/*根据结构体成员的内存地址获取结构体的地址*/&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#ff3333&quot;&gt;kattr &lt;/font&gt;= &lt;font color=&quot;#3333ff&quot;&gt;container_of&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;attr&lt;/font&gt;, struct kobj_attribute, &lt;font color=&quot;#ff3333&quot;&gt;attr&lt;/font&gt;);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;if (&lt;font color=&quot;#ff3333&quot;&gt;kattr&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;show&lt;/font&gt;)&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;ret &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;kattr&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#3333ff&quot;&gt;show&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;kattr&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;buf&lt;/font&gt;);&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;return &lt;font color=&quot;#ff3333&quot;&gt;ret&lt;/font&gt;;&lt;/p&gt;&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="3800" y="760" width="520" height="150" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-305" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="3800" y="776" width="520" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-306" value="&lt;b&gt;lib/kobject.c&lt;br&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="3800" y="740" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-307" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;static const struct sysfs_ops *&lt;font color=&quot;#3333ff&quot;&gt;sysfs_file_ops&lt;/font&gt;(struct kernfs_node *&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;)&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;struct kobject *&lt;font color=&quot;#ff3333&quot;&gt;kobj &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;parent&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;priv&lt;/font&gt;;&lt;br&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;br&gt;&lt;/blockquote&gt;if (&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;flags &lt;/font&gt;&amp;amp; KERNFS_LOCKDEP)&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;font color=&quot;#3333ff&quot;&gt;lockdep_assert_held&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;kn&lt;/font&gt;);&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;return &lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;ktype &lt;/font&gt;? &lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;ktype&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;sysfs_ops &lt;/font&gt;: NULL;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="4640" y="2121" width="440" height="100" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-308" value="&lt;b&gt;fs/sysfs/file.c&lt;br&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="4640" y="2101" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-309" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="4640" y="2136" width="440" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-310" value="&lt;p style=&quot;text-align: center ; margin: 4px 0px 0px&quot;&gt;&lt;b&gt;static inline size_t &lt;font color=&quot;#3333ff&quot;&gt;seq_get_buf&lt;/font&gt;(struct seq_file *&lt;font color=&quot;#ff3333&quot;&gt;m&lt;/font&gt;, char **&lt;font color=&quot;#ff3333&quot;&gt;bufp&lt;/font&gt;)&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;BUG_ON(&lt;font color=&quot;#ff3333&quot;&gt;m&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;count &lt;/font&gt;&amp;gt; &lt;font color=&quot;#ff3333&quot;&gt;m&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;size&lt;/font&gt;);&lt;br&gt;if (&lt;font color=&quot;#ff3333&quot;&gt;m&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;count &lt;/font&gt;&amp;lt; &lt;font color=&quot;#ff3333&quot;&gt;m&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;size&lt;/font&gt;)&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;*&lt;font color=&quot;#ff3333&quot;&gt;bufp &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;m&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;buf &lt;/font&gt;+ &lt;font color=&quot;#ff3333&quot;&gt;m&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;count&lt;/font&gt;;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;else&lt;br&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;*&lt;font color=&quot;#ff3333&quot;&gt;bufp &lt;/font&gt;= NULL;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;br&gt;&lt;/blockquote&gt;return &lt;font color=&quot;#ff3333&quot;&gt;m&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;size &lt;/font&gt;- &lt;font color=&quot;#ff3333&quot;&gt;m&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;count&lt;/font&gt;;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&#x9;&lt;/span&gt;&lt;/blockquote&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="4640" y="2321" width="440" height="120" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-311" value="&lt;b&gt;include/linux/seq_file.h&lt;br&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="4640" y="2299" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-312" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="4640" y="2336" width="440" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-313" value="&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center&quot;&gt;&lt;b&gt;struct kset *&lt;font color=&quot;#3333ff&quot;&gt;kset_create_and_add&lt;/font&gt;(const char *&lt;font color=&quot;#ff3333&quot;&gt;name&lt;/font&gt;,&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center&quot;&gt;&lt;b&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt; &lt;/span&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;const struct kset_uevent_ops *&lt;font color=&quot;#ff3333&quot;&gt;uevent_ops&lt;/font&gt;,&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center&quot;&gt;&lt;b&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&amp;nbsp; &amp;nbsp;struct kobject *&lt;font color=&quot;#ff3333&quot;&gt;parent_kobj&lt;/font&gt;)&lt;/b&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&#x9;struct kset *&lt;font color=&quot;#ff3333&quot;&gt;kset&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;int &lt;font color=&quot;#ff3333&quot;&gt;error&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#ff3333&quot;&gt;kset &lt;/font&gt;= &lt;font color=&quot;#3333ff&quot;&gt;kset_create&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;name&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;uevent_ops&lt;/font&gt;, &lt;font color=&quot;#ff3333&quot;&gt;parent_kobj&lt;/font&gt;);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;if (!&lt;font color=&quot;#ff3333&quot;&gt;kset&lt;/font&gt;)&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;return NULL;&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#ff3333&quot;&gt;error &lt;/font&gt;= &lt;font color=&quot;#3333ff&quot;&gt;kset_register&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;kset&lt;/font&gt;);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;if (&lt;font color=&quot;#ff3333&quot;&gt;error&lt;/font&gt;) {&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#3333ff&quot;&gt;kfree&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;kset&lt;/font&gt;);&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;return NULL;&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;}&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&#x9;return &lt;font color=&quot;#ff3333&quot;&gt;kset&lt;/font&gt;;&lt;/p&gt;&lt;/blockquote&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="1960" y="3520" width="640" height="280" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-314" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="1960" y="3573" width="640" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-315" value="&lt;b&gt;&lt;font color=&quot;#000000&quot;&gt;include/linux/kobject.c&lt;/font&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#FF3333;" vertex="1" parent="1">
          <mxGeometry x="1960" y="3500" width="140" height="20" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-316" value="&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center&quot;&gt;&lt;b&gt;static struct kset *&lt;font color=&quot;#3333ff&quot;&gt;kset_create&lt;/font&gt;(const char *&lt;font color=&quot;#ff3333&quot;&gt;name&lt;/font&gt;,const struct kset_uevent_ops *&lt;font color=&quot;#ff3333&quot;&gt;uevent_ops&lt;/font&gt;,&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center&quot;&gt;&lt;b&gt;struct kobject *&lt;font color=&quot;#ff3333&quot;&gt;parent_kobj&lt;/font&gt;)&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;struct kset *&lt;font color=&quot;#ff3333&quot;&gt;kset&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;int &lt;font color=&quot;#ff3333&quot;&gt;retval&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#ff3333&quot;&gt;kset &lt;/font&gt;= &lt;font color=&quot;#3333ff&quot;&gt;kzalloc&lt;/font&gt;(sizeof(*&lt;font color=&quot;#ff3333&quot;&gt;kset&lt;/font&gt;), GFP_KERNEL);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;if (!&lt;font color=&quot;#ff3333&quot;&gt;kset&lt;/font&gt;)&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;return NULL;&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#ff3333&quot;&gt;retval &lt;/font&gt;= &lt;font color=&quot;#3333ff&quot;&gt;kobject_set_name&lt;/font&gt;(&amp;amp;&lt;font color=&quot;#ff3333&quot;&gt;kset&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;, &quot;%s&quot;, &lt;font color=&quot;#ff3333&quot;&gt;name&lt;/font&gt;);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;if (&lt;font color=&quot;#ff3333&quot;&gt;retval&lt;/font&gt;) {&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#3333ff&quot;&gt;kfree&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;kset&lt;/font&gt;);&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;return NULL;&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;}&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;font color=&quot;#999999&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;/*注册消息发送接口*/&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#ff3333&quot;&gt;kset&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;uevent_ops &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;uevent_ops&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#ff3333&quot;&gt;kset&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;.&lt;font color=&quot;#ff3333&quot;&gt;parent &lt;/font&gt;= &lt;font color=&quot;#ff3333&quot;&gt;parent_kobj&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#ff3333&quot;&gt;kset&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;.&lt;font color=&quot;#ff3333&quot;&gt;ktype &lt;/font&gt;= &amp;amp;kset_ktype;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#ff3333&quot;&gt;kset&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;.&lt;font color=&quot;#ff3333&quot;&gt;kset &lt;/font&gt;= NULL;&lt;span style=&quot;white-space: pre&quot;&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#999999&quot;&gt;// 不能指向自己&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;return &lt;font color=&quot;#ff3333&quot;&gt;kset&lt;/font&gt;;&lt;/p&gt;&lt;/blockquote&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="2680" y="3520" width="640" height="390" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-317" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="2680" y="3555" width="640" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-318" value="&lt;b&gt;&lt;font color=&quot;#000000&quot;&gt;include/linux/kobject.c&lt;/font&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#FF3333;" vertex="1" parent="1">
          <mxGeometry x="2680" y="3500" width="140" height="20" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-319" value="&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center&quot;&gt;&lt;b&gt;int &lt;font color=&quot;#3333ff&quot;&gt;kset_register&lt;/font&gt;(struct kset *&lt;font color=&quot;#ff3333&quot;&gt;k&lt;/font&gt;)&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;int &lt;font color=&quot;#ff3333&quot;&gt;err&lt;/font&gt;;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;if (!&lt;font color=&quot;#ff3333&quot;&gt;k&lt;/font&gt;)&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&#x9;&lt;/span&gt;return -EINVAL;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#3333ff&quot;&gt;kset_init&lt;/font&gt;(&lt;font color=&quot;#ff3333&quot;&gt;k&lt;/font&gt;);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#ff3333&quot;&gt;err &lt;/font&gt;= &lt;font color=&quot;#3333ff&quot;&gt;kobject_add_internal&lt;/font&gt;(&amp;amp;&lt;font color=&quot;#ff3333&quot;&gt;k&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;if (&lt;font color=&quot;#ff3333&quot;&gt;err&lt;/font&gt;)&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;return &lt;font color=&quot;#ff3333&quot;&gt;err&lt;/font&gt;;&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&#x9;&lt;font color=&quot;#999999&quot;&gt;/*发送驱动模型消息到应用层*/&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#3333ff&quot;&gt;kobject_uevent&lt;/font&gt;(&amp;amp;&lt;font color=&quot;#ff3333&quot;&gt;k&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;, KOBJ_ADD);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;return 0;&lt;/p&gt;&lt;/blockquote&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="2680" y="4000" width="320" height="260" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-320" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="2680" y="4016" width="320" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-321" value="&lt;b&gt;&lt;font color=&quot;#000000&quot;&gt;include/linux/kobject.c&lt;/font&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#FF3333;" vertex="1" parent="1">
          <mxGeometry x="2680" y="3980" width="140" height="20" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-322" value="&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center&quot;&gt;&lt;b&gt;void &lt;font color=&quot;#3333ff&quot;&gt;kset_init&lt;/font&gt;(struct kset *&lt;font color=&quot;#ff3333&quot;&gt;k&lt;/font&gt;)&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#3333ff&quot;&gt;kobject_init_internal&lt;/font&gt;(&amp;amp;&lt;font color=&quot;#ff3333&quot;&gt;k&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;kobj&lt;/font&gt;);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;INIT_LIST_HEAD(&amp;amp;&lt;font color=&quot;#ff3333&quot;&gt;k&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;list&lt;/font&gt;);&lt;/p&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;span&gt;&#x9;&lt;/span&gt;&lt;font color=&quot;#3333ff&quot;&gt;spin_lock_init&lt;/font&gt;(&amp;amp;&lt;font color=&quot;#ff3333&quot;&gt;k&lt;/font&gt;-&amp;gt;&lt;font color=&quot;#ff3333&quot;&gt;list_lock&lt;/font&gt;);&lt;/p&gt;&lt;/blockquote&gt;&lt;p style=&quot;margin: 4px 0px 0px&quot;&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;spacingLeft=0;" vertex="1" parent="1">
          <mxGeometry x="3080" y="4000" width="280" height="80" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-323" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" vertex="1" parent="1">
          <mxGeometry x="3080" y="4016" width="280" height="8" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-324" value="&lt;b&gt;&lt;font color=&quot;#000000&quot;&gt;include/linux/kobject.c&lt;/font&gt;&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;fontColor=#FF3333;" vertex="1" parent="1">
          <mxGeometry x="3080" y="3980" width="140" height="20" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-325" value="" style="endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeWidth=5;fillColor=#fff2cc;strokeColor=#d6b656;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1660" y="3530.71" as="sourcePoint" />
            <mxPoint x="2120" y="3530.71" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-326" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeColor=#82b366;strokeWidth=5;fillColor=#d5e8d4;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2280" y="3646" as="sourcePoint" />
            <mxPoint x="2733" y="3536" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2640" y="3606" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-327" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeColor=#82b366;strokeWidth=5;fillColor=#d5e8d4;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2150" y="3716" as="sourcePoint" />
            <mxPoint x="2750" y="4006" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2640" y="3866" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-328" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeColor=#82b366;strokeWidth=5;fillColor=#d5e8d4;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2780" y="4118" as="sourcePoint" />
            <mxPoint x="3140" y="4006" as="targetPoint" />
            <Array as="points">
              <mxPoint x="3040" y="3986" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-329" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeColor=#82b366;strokeWidth=5;fillColor=#d5e8d4;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2750" y="1490" as="sourcePoint" />
            <mxPoint x="3120" y="1530" as="targetPoint" />
            <Array as="points">
              <mxPoint x="3040" y="1550" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-330" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeColor=#82b366;strokeWidth=5;fillColor=#d5e8d4;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2830" y="1360" as="sourcePoint" />
            <mxPoint x="3090" y="1290" as="targetPoint" />
            <Array as="points">
              <mxPoint x="3040" y="1330" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-331" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeColor=#82b366;strokeWidth=5;fillColor=#d5e8d4;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="3250" y="1730" as="sourcePoint" />
            <mxPoint x="3640" y="1530" as="targetPoint" />
            <Array as="points">
              <mxPoint x="3520" y="1630" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-332" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeColor=#82b366;strokeWidth=5;fillColor=#d5e8d4;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="3930" y="1601" as="sourcePoint" />
            <mxPoint x="4090" y="1530" as="targetPoint" />
            <Array as="points">
              <mxPoint x="4000" y="1560" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-333" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeColor=#82b366;strokeWidth=5;fillColor=#d5e8d4;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="4380" y="1830" as="sourcePoint" />
            <mxPoint x="4640" y="1530" as="targetPoint" />
            <Array as="points">
              <mxPoint x="4560" y="1560" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-334" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeColor=#82b366;strokeWidth=5;fillColor=#d5e8d4;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="4940" y="1680" as="sourcePoint" />
            <mxPoint x="5240" y="1530" as="targetPoint" />
            <Array as="points">
              <mxPoint x="5160" y="1550" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-335" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeColor=#82b366;strokeWidth=5;fillColor=#d5e8d4;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1530" y="1080" as="sourcePoint" />
            <mxPoint x="2010" y="1010" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1920" y="1030" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-336" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeColor=#82b366;strokeWidth=5;fillColor=#d5e8d4;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1654" y="1160" as="sourcePoint" />
            <mxPoint x="1974" y="1290" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1920" y="1230" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-337" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeColor=#82b366;strokeWidth=5;fillColor=#d5e8d4;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2220" y="1130" as="sourcePoint" />
            <mxPoint x="2540" y="930" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2400" y="1044" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-338" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeColor=#82b366;strokeWidth=5;fillColor=#d5e8d4;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2270" y="1380" as="sourcePoint" />
            <mxPoint x="2580" y="1290" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2480" y="1340" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-339" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeColor=#82b366;strokeWidth=5;fillColor=#d5e8d4;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2700" y="960" as="sourcePoint" />
            <mxPoint x="3120" y="930" as="targetPoint" />
            <Array as="points">
              <mxPoint x="3000" y="950" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-340" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeColor=#82b366;strokeWidth=5;fillColor=#d5e8d4;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1630" y="2170" as="sourcePoint" />
            <mxPoint x="1920" y="2130" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1840" y="2150" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-341" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeColor=#82b366;strokeWidth=5;fillColor=#d5e8d4;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2190" y="2311" as="sourcePoint" />
            <mxPoint x="2420" y="2131" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2360" y="2191" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-342" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeColor=#82b366;strokeWidth=5;fillColor=#d5e8d4;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2800" y="2301" as="sourcePoint" />
            <mxPoint x="2990" y="2131" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2880" y="2181" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-343" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeColor=#82b366;strokeWidth=5;fillColor=#d5e8d4;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="3330" y="2561" as="sourcePoint" />
            <mxPoint x="3566" y="2251" as="targetPoint" />
            <Array as="points">
              <mxPoint x="3440" y="2401" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-344" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeColor=#82b366;strokeWidth=5;fillColor=#d5e8d4;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="3698" y="2144" as="sourcePoint" />
            <mxPoint x="4178" y="2135" as="targetPoint" />
            <Array as="points">
              <mxPoint x="3920" y="2145" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-345" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeColor=#82b366;strokeWidth=5;fillColor=#d5e8d4;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="4440" y="2173" as="sourcePoint" />
            <mxPoint x="4660" y="2133" as="targetPoint" />
            <Array as="points">
              <mxPoint x="4600" y="2173" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-346" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeColor=#82b366;strokeWidth=5;fillColor=#d5e8d4;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="4320" y="2231" as="sourcePoint" />
            <mxPoint x="4680" y="2331" as="targetPoint" />
            <Array as="points">
              <mxPoint x="4600" y="2281" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-347" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeColor=#d6b656;strokeWidth=5;fillColor=#fff2cc;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1170" y="2130" as="sourcePoint" />
            <mxPoint x="1590" y="2150" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1320" y="2140" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-348" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeColor=#d6b656;strokeWidth=5;fillColor=#fff2cc;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="790" y="2131" as="sourcePoint" />
            <mxPoint x="960" y="2241" as="targetPoint" />
            <Array as="points">
              <mxPoint x="880" y="2151" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-349" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeColor=#d6b656;strokeWidth=5;fillColor=#fff2cc;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="300" y="2151" as="sourcePoint" />
            <mxPoint x="700" y="2131" as="targetPoint" />
            <Array as="points">
              <mxPoint x="600" y="2181" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-350" value="" style="endArrow=none;html=1;rounded=0;fontColor=#FF3333;strokeColor=#d6b656;strokeWidth=5;fillColor=#fff2cc;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1320" y="1010" as="sourcePoint" />
            <mxPoint x="1380" y="1010" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-351" value="" style="endArrow=none;html=1;rounded=0;fontColor=#FF3333;strokeColor=#d6b656;strokeWidth=5;fillColor=#fff2cc;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1320" y="1008" as="sourcePoint" />
            <mxPoint x="1320" y="1450" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-352" value="" style="endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeColor=#d6b656;strokeWidth=5;fillColor=#fff2cc;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1320" y="1450" as="sourcePoint" />
            <mxPoint x="1510" y="1450" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-353" value="" style="edgeStyle=elbowEdgeStyle;elbow=vertical;endArrow=classic;html=1;rounded=0;fontColor=#FF3333;strokeColor=#d6b656;strokeWidth=5;fillColor=#fff2cc;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="rQGNHsxmuD68EuWlFp72-197">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1550" y="2060" as="sourcePoint" />
            <mxPoint x="1690" y="2120" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1620" y="1960" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-354" value="&lt;font style=&quot;font-size: 24px&quot;&gt;定义属性和属性读写函数&lt;/font&gt;" style="text;html=1;strokeColor=#b85450;fillColor=#f8cecc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="225" y="2070" width="270" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-355" value="&lt;font style=&quot;font-size: 24px&quot;&gt;定义属性组&lt;/font&gt;" style="text;html=1;strokeColor=#6c8ebf;fillColor=#dae8fc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1035" y="2071" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-356" value="&lt;span style=&quot;font-size: 24px&quot;&gt;只将属性绑定到kobject&lt;/span&gt;" style="text;html=1;strokeColor=#6c8ebf;fillColor=#dae8fc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="612.5" y="2071" width="255" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-357" value="&lt;span style=&quot;font-size: 24px&quot;&gt;根据属性找到kobject内自定义的属性操作函数&lt;/span&gt;" style="text;html=1;strokeColor=#b85450;fillColor=#f8cecc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="3880" y="730" width="490" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-358" value="&lt;span style=&quot;font-size: 24px&quot;&gt;初始化kobj_type和其它成员&lt;/span&gt;" style="text;html=1;strokeColor=#6c8ebf;fillColor=#dae8fc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="2570.63" y="870" width="298.75" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-359" value="&lt;span style=&quot;font-size: 24px&quot;&gt;创建kernfs_node&lt;/span&gt;" style="text;html=1;strokeColor=#6c8ebf;fillColor=#dae8fc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="2107" y="1240" width="186" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-360" value="&lt;span style=&quot;font-size: 24px&quot;&gt;创建单个属性文件的kernfs_node&lt;/span&gt;" style="text;html=1;strokeColor=#6c8ebf;fillColor=#dae8fc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="3581.25" y="2210" width="357.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-361" value="&lt;span style=&quot;font-size: 24px&quot;&gt;在kobject目录下创建每个属性的文件&lt;/span&gt;" style="text;html=1;strokeColor=#6c8ebf;fillColor=#dae8fc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="2423.5" y="2070" width="395" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-362" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontSize=24;strokeWidth=5;fillColor=#fff2cc;strokeColor=#d6b656;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="3230" y="2461" as="sourcePoint" />
            <mxPoint x="3510" y="2131" as="targetPoint" />
            <Array as="points">
              <mxPoint x="3430" y="2441" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-363" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontSize=24;strokeWidth=5;fillColor=#fff2cc;strokeColor=#d6b656;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2220" y="1120" as="sourcePoint" />
            <mxPoint x="3090" y="770" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2390" y="980" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-364" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontSize=24;strokeWidth=5;fillColor=#fff2cc;strokeColor=#d6b656;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="3290" y="810" as="sourcePoint" />
            <mxPoint x="3470" y="770" as="targetPoint" />
            <Array as="points">
              <mxPoint x="3400" y="790" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-365" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontSize=24;strokeWidth=5;fillColor=#d5e8d4;strokeColor=#82b366;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="3612" y="810" as="sourcePoint" />
            <mxPoint x="3832" y="770" as="targetPoint" />
            <Array as="points">
              <mxPoint x="3762" y="790" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-366" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontSize=24;strokeWidth=5;fillColor=#fff2cc;strokeColor=#d6b656;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="4960" y="2205.5" as="sourcePoint" />
            <mxPoint x="5240" y="2084.5" as="targetPoint" />
            <Array as="points">
              <mxPoint x="5160" y="2145.5" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-367" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontSize=24;strokeWidth=5;fillColor=#fff2cc;strokeColor=#d6b656;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="5390" y="2012" as="sourcePoint" />
            <mxPoint x="1520" y="1630" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1920" y="1820" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-368" value="&lt;span style=&quot;font-size: 24px&quot;&gt;根据&lt;/span&gt;&lt;span style=&quot;font-size: 24px&quot;&gt;属性文件的&lt;/span&gt;&lt;span style=&quot;font-size: 24px&quot;&gt;kernfs_node&lt;/span&gt;&lt;span style=&quot;font-size: 24px&quot;&gt;找到&lt;br&gt;对应的kobject从而取出属性操作函数&lt;/span&gt;" style="text;html=1;strokeColor=#6c8ebf;fillColor=#dae8fc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="4720" y="2055" width="400" height="60" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-369" value="&lt;span&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;为什么只绑定属性？&lt;/font&gt;&lt;br&gt;1. 只通过属性即可定位到属性操作函数；&lt;br&gt;2. 自定义的属性操作函数不能直接被调用，需要被其它函数封装之后才能使用，即完成&lt;/span&gt;&lt;span style=&quot;text-align: center&quot;&gt;file_operations&lt;/span&gt;&lt;span&gt;到&lt;/span&gt;&lt;span style=&quot;text-align: center&quot;&gt;seq_operations&lt;/span&gt;&lt;span&gt;到&lt;/span&gt;&lt;span&gt;kernfs_ops到&lt;/span&gt;&lt;span&gt;sysfs_ops&lt;/span&gt;&lt;span&gt;的转换；&lt;br&gt;3. 自定义的属性操作函数（属性读写函数）应该为sysfs_ops结构体内的函数类型，本流程图以show函数为例进行说明，其它操作函数类似；&lt;br&gt;4. 内核代码绕这么一大圈是为了实现VFS到sysfs的转换。&lt;br&gt;&lt;/span&gt;" style="text;html=1;strokeColor=#b85450;fillColor=#f8cecc;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="610" y="2191" width="260" height="170" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-370" value="" style="endArrow=none;html=1;rounded=0;fontSize=24;strokeWidth=5;fillColor=#fff2cc;strokeColor=#d6b656;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="5430" y="2084.86" as="sourcePoint" />
            <mxPoint x="5720" y="2084.8599999999997" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-371" value="" style="endArrow=none;html=1;rounded=0;fontSize=24;strokeWidth=5;fillColor=#fff2cc;strokeColor=#d6b656;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="5720" y="2087" as="sourcePoint" />
            <mxPoint x="5720" y="680" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-372" value="" style="endArrow=none;html=1;rounded=0;fontSize=24;strokeWidth=5;fillColor=#fff2cc;strokeColor=#d6b656;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="3570" y="680" as="sourcePoint" />
            <mxPoint x="5720" y="680" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-373" value="" style="endArrow=classic;html=1;rounded=0;fontSize=24;strokeWidth=5;fillColor=#fff2cc;strokeColor=#d6b656;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="3569.63" y="678" as="sourcePoint" />
            <mxPoint x="3569.63" y="768" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-374" value="&lt;span style=&quot;font-size: 24px&quot;&gt;完成kernfs_ops到&lt;/span&gt;&lt;span style=&quot;font-size: 24px&quot;&gt;sysfs_ops&lt;/span&gt;&lt;span style=&quot;font-size: 24px&quot;&gt;的转换&lt;/span&gt;" style="text;html=1;strokeColor=#b85450;fillColor=#f8cecc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="4150" y="2071" width="380" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-375" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontSize=24;strokeWidth=5;fillColor=#fff2cc;strokeColor=#d6b656;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1610" y="3210" as="sourcePoint" />
            <mxPoint x="1930" y="2810" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1880" y="2910" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-376" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontSize=24;strokeWidth=5;fillColor=#d5e8d4;strokeColor=#82b366;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2098" y="2901" as="sourcePoint" />
            <mxPoint x="2298" y="2811" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2240" y="2860" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-377" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontSize=24;strokeWidth=5;fillColor=#fff2cc;strokeColor=#d6b656;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2570.63" y="2980" as="sourcePoint" />
            <mxPoint x="2790.63" y="2810" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2720.63" y="2830" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-378" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontSize=24;strokeWidth=5;fillColor=#d5e8d4;strokeColor=#82b366;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2570.63" y="2990" as="sourcePoint" />
            <mxPoint x="2780.63" y="2970" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2730.63" y="3010" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-379" value="" style="endArrow=none;html=1;rounded=0;fontSize=24;strokeWidth=5;fillColor=#d5e8d4;strokeColor=#82b366;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1900" y="2828" as="sourcePoint" />
            <mxPoint x="1960" y="2828" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-380" value="" style="edgeStyle=segmentEdgeStyle;endArrow=classic;html=1;rounded=0;fontSize=24;strokeWidth=5;fillColor=#d5e8d4;strokeColor=#82b366;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1900" y="2826" as="sourcePoint" />
            <mxPoint x="2300" y="3210" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1900" y="3210" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-381" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontSize=24;strokeWidth=5;fillColor=#d5e8d4;strokeColor=#82b366;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2548.5" y="3242" as="sourcePoint" />
            <mxPoint x="2818.5" y="3212" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2758.5" y="3232" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-382" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontSize=24;strokeWidth=5;fillColor=#d5e8d4;strokeColor=#82b366;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2940" y="2880" as="sourcePoint" />
            <mxPoint x="3280" y="2810" as="targetPoint" />
            <Array as="points">
              <mxPoint x="3160" y="2850" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-383" value="&lt;span style=&quot;font-size: 24px&quot;&gt;完成&lt;/span&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;file_operations到&lt;/font&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;seq_operations的转换&lt;/font&gt;" style="text;html=1;strokeColor=#b85450;fillColor=#f8cecc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="2360" y="2730" width="240" height="60" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-384" value="&lt;span style=&quot;font-size: 24px&quot;&gt;完成&lt;/span&gt;&lt;font&gt;&lt;span style=&quot;font-size: 24px&quot;&gt;seq_operations到&lt;/span&gt;&lt;span style=&quot;text-align: left&quot;&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;kernfs_ops&lt;/font&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 24px&quot;&gt;的转换&lt;/span&gt;&lt;/font&gt;" style="text;html=1;strokeColor=#b85450;fillColor=#f8cecc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="3330" y="2730" width="220" height="60" as="geometry" />
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-385" value="" style="endArrow=none;html=1;rounded=0;fontSize=24;strokeWidth=5;fillColor=#d5e8d4;strokeColor=#82b366;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="3460" y="2854" as="sourcePoint" />
            <mxPoint x="4080" y="2854" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-386" value="" style="endArrow=none;html=1;rounded=0;fontSize=24;strokeWidth=5;fillColor=#d5e8d4;strokeColor=#82b366;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="4080" y="2856" as="sourcePoint" />
            <mxPoint x="4080" y="2190" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-387" value="" style="endArrow=none;html=1;rounded=0;fontSize=24;strokeWidth=5;fillColor=#d5e8d4;strokeColor=#82b366;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="3440" y="2191" as="sourcePoint" />
            <mxPoint x="4080" y="2191" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-388" value="" style="edgeStyle=segmentEdgeStyle;endArrow=classic;html=1;rounded=0;fontSize=24;strokeWidth=5;fillColor=#d5e8d4;strokeColor=#82b366;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="3440" y="2191.5" as="sourcePoint" />
            <mxPoint x="3520" y="2146.5" as="targetPoint" />
            <Array as="points">
              <mxPoint x="3440" y="2146.5" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-389" value="" style="edgeStyle=elbowEdgeStyle;elbow=horizontal;endArrow=classic;html=1;rounded=0;fontSize=24;strokeWidth=5;fillColor=#d5e8d4;strokeColor=#82b366;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="2597" y="3288" as="sourcePoint" />
            <mxPoint x="2830" y="3328" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2760" y="3298" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rQGNHsxmuD68EuWlFp72-390" value="&lt;span style=&quot;font-size: 24px&quot;&gt;该函数并没有初始化kset成员，需要自己另外手动设置&lt;/span&gt;" style="text;html=1;strokeColor=#6c8ebf;fillColor=#dae8fc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1450" y="930" width="340" height="60" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
